# Lefthook configuration for shell-starter
# This runs validation checks before pushing to prevent CI failures

pre-push:
  commands:
    shellcheck:
      run: |
        echo "üîç Running ShellCheck..."
        if command -v shellcheck >/dev/null 2>&1; then
          # Run shellcheck on all shell files following the project's quality commands
          shellcheck lib/*.sh scripts/*.sh bin/* demo/* install.sh uninstall.sh
        else
          echo "‚ö†Ô∏è  ShellCheck not found. Install with: brew install shellcheck"
          exit 1
        fi
      glob: "*.sh"
      
    shfmt:
      run: |
        echo "üé® Checking code formatting with shfmt..."
        if command -v shfmt >/dev/null 2>&1; then
          # Check formatting on all shell files following the project's quality commands
          shfmt -d lib/*.sh scripts/*.sh bin/* demo/* install.sh uninstall.sh
        else
          echo "‚ö†Ô∏è  shfmt not found. Install with: brew install shfmt"
          exit 1
        fi
      glob: "*.sh"
    
    tests:
      run: |
        echo "üß™ Running tests..."
        if [ -f "./tests/run-tests-ci.sh" ]; then
          chmod +x ./tests/run-tests-ci.sh
          ./tests/run-tests-ci.sh
        else
          echo "‚ö†Ô∏è  Test runner not found: ./tests/run-tests-ci.sh"
          exit 1
        fi
      glob: "*.{sh,bats}"
